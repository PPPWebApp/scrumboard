<main>
  <h1>Mangage members of the team</h1>

  <form [formGroup]="form" (ngSubmit)="onFormSubmit()">
    <mat-form-field class="example-full-width">
      <input matInput placeholder="Email" [formControl]="emailFormControl">
      <mat-error *ngIf="emailFormControl?.hasError('email') && !emailFormControl?.hasError('required')">
        Please enter a valid email address
      </mat-error>
      <mat-error *ngIf="emailFormControl.hasError('required')">
        Email is <strong>required</strong>
      </mat-error>
    </mat-form-field>
    <button type="submit" mat-raised-button>Add user</button>
  </form>

  <!-- <input matInput placeholder="Favorite food">
  <button mat-raised-button (click)="addMember(team.id, team.name, inputValue)" >Add user</button> -->
  <div id="members">
    <div *ngFor="let member of (team$ | async)?.members | mapToIterable" id="memberWrapper">
      <div id="profilePic">
        <img *ngIf="member.val.imgUrl" src="{{member.val.imgUrl}}">
        <mat-icon>account_circle</mat-icon>
      </div>
      <strong id="nameTxt">{{ member.val.name }}
        <span *ngIf="member.val.isAdmin" id="memberTypeTxt">Admin</span>
      </strong>
      <mat-menu #memberOptionsMenu="matMenu">
        <button mat-menu-item *ngIf="!member.val.isAdmin" (click)="promoteAdmin(member.key)">
          <mat-icon>promote</mat-icon>
          <span>Set member to admin</span>
        </button>
        <button mat-menu-item *ngIf="member.val.isAdmin" (click)="removeAdmin(member.key)">
          <mat-icon>promote</mat-icon>
          <span>Remove admin priveliges</span>
        </button>
        <button mat-menu-item (click)="deleteMember(member.key)">
          <mat-icon>exit_to_app</mat-icon>
          <span>Remove member</span>
        </button>
      </mat-menu>
      <button class="menuBtn" mat-icon-button [matMenuTriggerFor]="memberOptionsMenu" (click)="$event.stopPropagation()">
        <mat-icon>more_vert</mat-icon>
      </button>
    </div>
  </div>
</main>
